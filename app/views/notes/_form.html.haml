= form_for @note do |f|
  = f.error_messages
  .control-group
    - if @chart.blank?
      = f.select :chart_id, current_user.charts.sort_by{|c| c.client.last }.collect {|c| [ c.client.full_name, c.id ] }, {:include_blank => false}
    - else
      = f.hidden_field :chart_id, :value => params[:chart]
      %strong= @chart.client.full_name
  .control-group
    = f.label :date, :class => 'control-label'
    .controls
      %div{:id => "datepicker", :class => "input-append date"}
        = f.text_field :date, "data-format" => "yyyy-MM-dd", :value => Date.today, :class => 'input-small', :default => Time.now
        %span{:class => "add-on"}
          %i.icon-calendar
  .control-group
    = f.label :details, :class => 'control-label'
    .controls
      = f.text_area :details, :class => 'text_area span5', :rows => 5
  .control-group
    = f.label "Tags", :class => 'control-label'
    .controls
      = f.text_field :tag_names, :class => 'text_field', :id => 'tags'
  .form-actions
    = f.submit nil, :class => 'btn btn-primary'
    = link_to t('.cancel', :default => t("helpers.links.cancel")), charts_path, :class => 'btn'

- if false
  %p
    = f.label :date
    %br
    = f.date_select :date
  %p
    = f.label :details
    %br
    = f.text_area :details
  %p
    = f.label :tag_names, "Tags"
    = f.text_field :tag_names, :id => 'tags'
  %p
    = f.submit

  = stylesheet_link_tag "jquery.tagit.css"
  = javascript_include_tag "http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"
  = javascript_include_tag "https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.min.js"
  = javascript_include_tag "tag-it.js"

  %script
    var tags = "#{@tags.join(',')}";
    $('#tags').tagit({availableTags: tags.split(',')});


:javascript
  $('#datepicker').datepicker({
    format: 'yyyy-mm-dd',
    todayHighlight: true
  });

  var tags = "#{@tags.join(',')}";
  $('#tags').tagit({
    availableTags: tags.split(','),
    allowSpaces: true
  });

  